{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\senior-project\\\\web-template-new\\\\frontend\\\\src\\\\components\\\\charts\\\\LineTimeChart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef } from \"react\";\nimport Chart from \"chart.js/auto\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction toTs(v) {\n  const t = new Date(v).getTime();\n  return Number.isFinite(t) ? t : null;\n}\nexport default function LineTimeChart({\n  id,\n  rows = [],\n  xKey = \"Timestamp\",\n  yKeys = [],\n  labels = {},\n  // optional: { yKey: \"Label\" }\n  chartRef,\n  // optional: ref passed from parent for hover sync later\n  onHoverX,\n  onMouseLeave\n}) {\n  _s();\n  const canvasRef = useRef(null);\n  const onHoverXRef = useRef(null);\n  const prepared = useMemo(() => {\n    const safeRows = Array.isArray(rows) ? rows : [];\n    const data = safeRows.map(r => {\n      const x = r === null || r === void 0 ? void 0 : r[xKey];\n      const ts = toTs(x);\n      if (!ts) return null;\n      return {\n        ...r,\n        __ts: ts\n      };\n    }).filter(Boolean).sort((a, b) => a.__ts - b.__ts);\n    return data;\n  }, [rows, xKey]);\n  useEffect(() => {\n    onHoverXRef.current = onHoverX || null;\n  }, [onHoverX]);\n  useEffect(() => {\n    if (onMouseLeave) {\n      const handleMouseLeave = () => {\n        onMouseLeave();\n      };\n      const canvas = canvasRef.current;\n      if (canvas) {\n        canvas.addEventListener(\"mouseleave\", handleMouseLeave);\n        return () => canvas.removeEventListener(\"mouseleave\", handleMouseLeave);\n      }\n    }\n  }, [onMouseLeave]);\n  useEffect(() => {\n    if (!canvasRef.current) return;\n\n    // destroy existing chart if any\n    const existing = Chart.getChart(canvasRef.current);\n    if (existing) existing.destroy();\n    if (!prepared.length || !yKeys.length) return;\n    const datasets = yKeys.map(k => ({\n      label: labels[k] || k,\n      data: prepared.map(r => {\n        var _r$k;\n        return Number((_r$k = r === null || r === void 0 ? void 0 : r[k]) !== null && _r$k !== void 0 ? _r$k : null);\n      }),\n      spanGaps: true,\n      tension: 0.3,\n      pointRadius: 0\n    }));\n    const chart = new Chart(canvasRef.current, {\n      type: \"line\",\n      data: {\n        labels: prepared.map(r => r.__ts),\n        // store timestamps\n        datasets\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        interaction: {\n          mode: \"index\",\n          intersect: false\n        },\n        onHover: (_event, elements, chart) => {\n          const cb = onHoverXRef.current;\n          if (!cb) return;\n          if (elements && elements.length) {\n            var _chart$data$labels$id, _chart$data$labels;\n            const idx = elements[0].index;\n            const x = (_chart$data$labels$id = (_chart$data$labels = chart.data.labels) === null || _chart$data$labels === void 0 ? void 0 : _chart$data$labels[idx]) !== null && _chart$data$labels$id !== void 0 ? _chart$data$labels$id : null;\n            cb(x, idx);\n          } else {\n            cb(null, null);\n          }\n        },\n        plugins: {\n          legend: {\n            display: true\n          },\n          tooltip: {\n            callbacks: {\n              title: items => {\n                var _items$;\n                const v = items === null || items === void 0 ? void 0 : (_items$ = items[0]) === null || _items$ === void 0 ? void 0 : _items$.label;\n                return v ? new Date(Number(v)).toLocaleString() : \"\";\n              }\n            }\n          }\n        },\n        scales: {\n          x: {\n            ticks: {\n              callback: (v, idx, ticks) => {\n                var _ticks$idx;\n                const ts = ticks === null || ticks === void 0 ? void 0 : (_ticks$idx = ticks[idx]) === null || _ticks$idx === void 0 ? void 0 : _ticks$idx.value;\n                return ts ? new Date(Number(ts)).toLocaleDateString() : \"\";\n              },\n              maxRotation: 0,\n              autoSkip: true\n            }\n          },\n          y: {\n            ticks: {\n              precision: 0\n            }\n          }\n        }\n      }\n    });\n\n    // expose chart instance to parent if requested\n    if (chartRef) chartRef.current = chart;\n    return () => {\n      chart.destroy();\n      if (chartRef) chartRef.current = null;\n    };\n  }, [prepared, yKeys, labels]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      id: id,\n      ref: canvasRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n}\n_s(LineTimeChart, \"yknl8gniAssUuyv3nIKPGOHaOaM=\");\n_c = LineTimeChart;\nvar _c;\n$RefreshReg$(_c, \"LineTimeChart\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","Chart","jsxDEV","_jsxDEV","toTs","v","t","Date","getTime","Number","isFinite","LineTimeChart","id","rows","xKey","yKeys","labels","chartRef","onHoverX","onMouseLeave","_s","canvasRef","onHoverXRef","prepared","safeRows","Array","isArray","data","map","r","x","ts","__ts","filter","Boolean","sort","a","b","current","handleMouseLeave","canvas","addEventListener","removeEventListener","existing","getChart","destroy","length","datasets","k","label","_r$k","spanGaps","tension","pointRadius","chart","type","options","responsive","maintainAspectRatio","interaction","mode","intersect","onHover","_event","elements","cb","_chart$data$labels$id","_chart$data$labels","idx","index","plugins","legend","display","tooltip","callbacks","title","items","_items$","toLocaleString","scales","ticks","callback","_ticks$idx","value","toLocaleDateString","maxRotation","autoSkip","y","precision","style","width","height","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/senior-project/web-template-new/frontend/src/components/charts/LineTimeChart.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef } from \"react\";\r\nimport Chart from \"chart.js/auto\";\r\n\r\nfunction toTs(v) {\r\n  const t = new Date(v).getTime();\r\n  return Number.isFinite(t) ? t : null;\r\n}\r\n\r\nexport default function LineTimeChart({\r\n  id,\r\n  rows = [],\r\n  xKey = \"Timestamp\",\r\n  yKeys = [],\r\n  labels = {}, // optional: { yKey: \"Label\" }\r\n  chartRef,    // optional: ref passed from parent for hover sync later\r\n  onHoverX,\r\n  onMouseLeave,\r\n}) {\r\n  const canvasRef = useRef(null);\r\n  const onHoverXRef = useRef(null);\r\n\r\n  const prepared = useMemo(() => {\r\n    const safeRows = Array.isArray(rows) ? rows : [];\r\n    const data = safeRows\r\n      .map((r) => {\r\n        const x = r?.[xKey];\r\n        const ts = toTs(x);\r\n        if (!ts) return null;\r\n        return { ...r, __ts: ts };\r\n      })\r\n      .filter(Boolean)\r\n      .sort((a, b) => a.__ts - b.__ts);\r\n\r\n    return data;\r\n  }, [rows, xKey]);\r\n\r\n  useEffect(() => {\r\n    onHoverXRef.current = onHoverX || null;\r\n  }, [onHoverX]);\r\n\r\n  useEffect(() => {\r\n    if (onMouseLeave) {\r\n      const handleMouseLeave = () => {\r\n        onMouseLeave();\r\n      };\r\n      const canvas = canvasRef.current;\r\n      if (canvas) {\r\n        canvas.addEventListener(\"mouseleave\", handleMouseLeave);\r\n        return () => canvas.removeEventListener(\"mouseleave\", handleMouseLeave);\r\n      }\r\n    }\r\n  }, [onMouseLeave]);\r\n\r\n  useEffect(() => {\r\n    if (!canvasRef.current) return;\r\n\r\n    // destroy existing chart if any\r\n    const existing = Chart.getChart(canvasRef.current);\r\n    if (existing) existing.destroy();\r\n\r\n    if (!prepared.length || !yKeys.length) return;\r\n\r\n    const datasets = yKeys.map((k) => ({\r\n      label: labels[k] || k,\r\n      data: prepared.map((r) => Number(r?.[k] ?? null)),\r\n      spanGaps: true,\r\n      tension: 0.3,\r\n      pointRadius: 0,\r\n    }));\r\n\r\n    const chart = new Chart(canvasRef.current, {\r\n      type: \"line\",\r\n      data: {\r\n        labels: prepared.map((r) => r.__ts), // store timestamps\r\n        datasets,\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        interaction: { mode: \"index\", intersect: false },\r\n        onHover: (_event, elements, chart) => {\r\n          const cb = onHoverXRef.current;\r\n          if (!cb) return;\r\n\r\n          if (elements && elements.length) {\r\n            const idx = elements[0].index;\r\n            const x = chart.data.labels?.[idx] ?? null;\r\n            cb(x, idx);\r\n          } else {\r\n            cb(null, null);\r\n          }\r\n        },\r\n        plugins: {\r\n          legend: { display: true },\r\n          tooltip: {\r\n            callbacks: {\r\n              title: (items) => {\r\n                const v = items?.[0]?.label;\r\n                return v ? new Date(Number(v)).toLocaleString() : \"\";\r\n              },\r\n            },\r\n          },\r\n        },\r\n        scales: {\r\n          x: {\r\n            ticks: {\r\n              callback: (v, idx, ticks) => {\r\n                const ts = ticks?.[idx]?.value;\r\n                return ts ? new Date(Number(ts)).toLocaleDateString() : \"\";\r\n              },\r\n              maxRotation: 0,\r\n              autoSkip: true,\r\n            },\r\n          },\r\n          y: {\r\n            ticks: { precision: 0 },\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    // expose chart instance to parent if requested\r\n    if (chartRef) chartRef.current = chart;\r\n\r\n    return () => {\r\n      chart.destroy();\r\n      if (chartRef) chartRef.current = null;\r\n    };\r\n  }, [prepared, yKeys, labels]);\r\n\r\n  return (\r\n    <div style={{ width: \"100%\", height: \"100%\" }}>\r\n      <canvas id={id} ref={canvasRef} />\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}