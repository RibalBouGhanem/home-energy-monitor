{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\senior-project\\\\website\\\\frontend\\\\src\\\\components\\\\charts\\\\BarTimeChart.js\",\n  _s = $RefreshSig$();\n// src/components/charts/BarTimeChart.js\nimport React, { useEffect, useMemo, useRef } from \"react\";\nimport Chart from \"chart.js/auto\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction toMs(v) {\n  if (v == null) return null;\n  // If already ms timestamp\n  if (typeof v === \"number\" && Number.isFinite(v)) return v;\n  // If numeric string\n  if (typeof v === \"string\" && /^\\d+$/.test(v)) return Number(v);\n  const t = new Date(v).getTime();\n  return Number.isFinite(t) ? t : null;\n}\nexport default function BarTimeChart({\n  id,\n  rows = [],\n  xKey = \"Timestamp\",\n  yKeys = [],\n  labels = {},\n  // { yKey: \"Label\" }\n  chartRef,\n  // optional ref object\n  maxBars = 14 // keep it looking clean; show last N points\n}) {\n  _s();\n  const canvasRef = useRef(null);\n\n  // Prepare/sort data safely\n  const prepared = useMemo(() => {\n    const src = Array.isArray(rows) ? rows : [];\n    const mapped = src.map(r => {\n      const ms = toMs(r === null || r === void 0 ? void 0 : r[xKey]);\n      if (ms == null) return null;\n      return {\n        ...r,\n        __ms: ms\n      };\n    }).filter(Boolean).sort((a, b) => a.__ms - b.__ms);\n\n    // Trim to last N for cleaner bars\n    if (maxBars && mapped.length > maxBars) {\n      return mapped.slice(mapped.length - maxBars);\n    }\n    return mapped;\n  }, [rows, xKey, maxBars]);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    // Destroy previous chart if exists\n    const existing = Chart.getChart(canvas);\n    if (existing) existing.destroy();\n    if (!prepared.length || !Array.isArray(yKeys) || yKeys.length === 0) return;\n\n    // Labels are timestamps (ms)\n    const xLabels = prepared.map(r => r.__ms);\n    const datasets = yKeys.map((k, idx) => {\n      const data = prepared.map(r => {\n        const n = Number(r === null || r === void 0 ? void 0 : r[k]);\n        return Number.isFinite(n) ? n : null;\n      });\n      return {\n        label: (labels === null || labels === void 0 ? void 0 : labels[k]) || k,\n        data,\n        borderWidth: 0,\n        // Let Chart.js pick colors by default (you asked not to create random color vars)\n        // Styling for “nice template” look:\n        borderRadius: 12,\n        borderSkipped: false,\n        barPercentage: 0.75,\n        categoryPercentage: 0.7,\n        // If multiple series, slightly thinner bars\n        ...(yKeys.length > 1 ? {\n          barPercentage: 0.6,\n          categoryPercentage: 0.72\n        } : {})\n      };\n    });\n    const chart = new Chart(canvas, {\n      type: \"bar\",\n      data: {\n        labels: xLabels,\n        datasets\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        layout: {\n          padding: {\n            top: 8,\n            right: 8,\n            bottom: 0,\n            left: 8\n          }\n        },\n        interaction: {\n          mode: \"index\",\n          intersect: false\n        },\n        plugins: {\n          legend: {\n            display: yKeys.length > 1,\n            labels: {\n              boxWidth: 10,\n              boxHeight: 10,\n              usePointStyle: true,\n              pointStyle: \"circle\"\n            }\n          },\n          tooltip: {\n            displayColors: yKeys.length > 1,\n            callbacks: {\n              title: items => {\n                var _items$;\n                const raw = items === null || items === void 0 ? void 0 : (_items$ = items[0]) === null || _items$ === void 0 ? void 0 : _items$.label;\n                const ms = toMs(raw);\n                return ms ? new Date(ms).toLocaleDateString() : \"\";\n              }\n            }\n          }\n        },\n        scales: {\n          x: {\n            grid: {\n              display: false\n            },\n            ticks: {\n              autoSkip: true,\n              maxRotation: 0,\n              callback: (_val, idx) => {\n                var _prepared$idx;\n                const ms = (_prepared$idx = prepared[idx]) === null || _prepared$idx === void 0 ? void 0 : _prepared$idx.__ms;\n                if (!ms) return \"\";\n                // short label like \"Mar 8\"\n                return new Date(ms).toLocaleDateString(undefined, {\n                  month: \"short\",\n                  day: \"numeric\"\n                });\n              }\n            }\n          },\n          y: {\n            beginAtZero: true,\n            grid: {\n              // subtle grid like modern dashboards\n              drawBorder: false\n            },\n            ticks: {\n              precision: 0,\n              maxTicksLimit: 5\n            }\n          }\n        }\n      }\n    });\n    if (chartRef) chartRef.current = chart;\n    return () => {\n      chart.destroy();\n      if (chartRef) chartRef.current = null;\n    };\n  }, [prepared, yKeys, labels, chartRef]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      id: id,\n      ref: canvasRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 159,\n    columnNumber: 5\n  }, this);\n}\n_s(BarTimeChart, \"0RjVZ5W4BZG/Grc2UiMddIZUZTI=\");\n_c = BarTimeChart;\nvar _c;\n$RefreshReg$(_c, \"BarTimeChart\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","Chart","jsxDEV","_jsxDEV","toMs","v","Number","isFinite","test","t","Date","getTime","BarTimeChart","id","rows","xKey","yKeys","labels","chartRef","maxBars","_s","canvasRef","prepared","src","Array","isArray","mapped","map","r","ms","__ms","filter","Boolean","sort","a","b","length","slice","canvas","current","existing","getChart","destroy","xLabels","datasets","k","idx","data","n","label","borderWidth","borderRadius","borderSkipped","barPercentage","categoryPercentage","chart","type","options","responsive","maintainAspectRatio","layout","padding","top","right","bottom","left","interaction","mode","intersect","plugins","legend","display","boxWidth","boxHeight","usePointStyle","pointStyle","tooltip","displayColors","callbacks","title","items","_items$","raw","toLocaleDateString","scales","x","grid","ticks","autoSkip","maxRotation","callback","_val","_prepared$idx","undefined","month","day","y","beginAtZero","drawBorder","precision","maxTicksLimit","style","width","height","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/senior-project/website/frontend/src/components/charts/BarTimeChart.js"],"sourcesContent":["// src/components/charts/BarTimeChart.js\r\nimport React, { useEffect, useMemo, useRef } from \"react\";\r\nimport Chart from \"chart.js/auto\";\r\n\r\nfunction toMs(v) {\r\n  if (v == null) return null;\r\n  // If already ms timestamp\r\n  if (typeof v === \"number\" && Number.isFinite(v)) return v;\r\n  // If numeric string\r\n  if (typeof v === \"string\" && /^\\d+$/.test(v)) return Number(v);\r\n  const t = new Date(v).getTime();\r\n  return Number.isFinite(t) ? t : null;\r\n}\r\n\r\nexport default function BarTimeChart({\r\n  id,\r\n  rows = [],\r\n  xKey = \"Timestamp\",\r\n  yKeys = [],\r\n  labels = {}, // { yKey: \"Label\" }\r\n  chartRef,    // optional ref object\r\n  maxBars = 14, // keep it looking clean; show last N points\r\n}) {\r\n  const canvasRef = useRef(null);\r\n\r\n  // Prepare/sort data safely\r\n  const prepared = useMemo(() => {\r\n    const src = Array.isArray(rows) ? rows : [];\r\n    const mapped = src\r\n      .map((r) => {\r\n        const ms = toMs(r?.[xKey]);\r\n        if (ms == null) return null;\r\n        return { ...r, __ms: ms };\r\n      })\r\n      .filter(Boolean)\r\n      .sort((a, b) => a.__ms - b.__ms);\r\n\r\n    // Trim to last N for cleaner bars\r\n    if (maxBars && mapped.length > maxBars) {\r\n      return mapped.slice(mapped.length - maxBars);\r\n    }\r\n    return mapped;\r\n  }, [rows, xKey, maxBars]);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    // Destroy previous chart if exists\r\n    const existing = Chart.getChart(canvas);\r\n    if (existing) existing.destroy();\r\n\r\n    if (!prepared.length || !Array.isArray(yKeys) || yKeys.length === 0) return;\r\n\r\n    // Labels are timestamps (ms)\r\n    const xLabels = prepared.map((r) => r.__ms);\r\n\r\n    const datasets = yKeys.map((k, idx) => {\r\n      const data = prepared.map((r) => {\r\n        const n = Number(r?.[k]);\r\n        return Number.isFinite(n) ? n : null;\r\n      });\r\n\r\n      return {\r\n        label: labels?.[k] || k,\r\n        data,\r\n        borderWidth: 0,\r\n        // Let Chart.js pick colors by default (you asked not to create random color vars)\r\n        // Styling for “nice template” look:\r\n        borderRadius: 12,\r\n        borderSkipped: false,\r\n        barPercentage: 0.75,\r\n        categoryPercentage: 0.7,\r\n        // If multiple series, slightly thinner bars\r\n        ...(yKeys.length > 1 ? { barPercentage: 0.6, categoryPercentage: 0.72 } : {}),\r\n      };\r\n    });\r\n\r\n    const chart = new Chart(canvas, {\r\n      type: \"bar\",\r\n      data: {\r\n        labels: xLabels,\r\n        datasets,\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        layout: {\r\n          padding: { top: 8, right: 8, bottom: 0, left: 8 },\r\n        },\r\n        interaction: {\r\n          mode: \"index\",\r\n          intersect: false,\r\n        },\r\n        plugins: {\r\n          legend: {\r\n            display: yKeys.length > 1,\r\n            labels: {\r\n              boxWidth: 10,\r\n              boxHeight: 10,\r\n              usePointStyle: true,\r\n              pointStyle: \"circle\",\r\n            },\r\n          },\r\n          tooltip: {\r\n            displayColors: yKeys.length > 1,\r\n            callbacks: {\r\n              title: (items) => {\r\n                const raw = items?.[0]?.label;\r\n                const ms = toMs(raw);\r\n                return ms ? new Date(ms).toLocaleDateString() : \"\";\r\n              },\r\n            },\r\n          },\r\n        },\r\n        scales: {\r\n          x: {\r\n            grid: {\r\n              display: false,\r\n            },\r\n            ticks: {\r\n              autoSkip: true,\r\n              maxRotation: 0,\r\n              callback: (_val, idx) => {\r\n                const ms = prepared[idx]?.__ms;\r\n                if (!ms) return \"\";\r\n                // short label like \"Mar 8\"\r\n                return new Date(ms).toLocaleDateString(undefined, {\r\n                  month: \"short\",\r\n                  day: \"numeric\",\r\n                });\r\n              },\r\n            },\r\n          },\r\n          y: {\r\n            beginAtZero: true,\r\n            grid: {\r\n              // subtle grid like modern dashboards\r\n              drawBorder: false,\r\n            },\r\n            ticks: {\r\n              precision: 0,\r\n              maxTicksLimit: 5,\r\n            },\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    if (chartRef) chartRef.current = chart;\r\n\r\n    return () => {\r\n      chart.destroy();\r\n      if (chartRef) chartRef.current = null;\r\n    };\r\n  }, [prepared, yKeys, labels, chartRef]);\r\n\r\n  return (\r\n    <div style={{ width: \"100%\", height: \"100%\" }}>\r\n      <canvas id={id} ref={canvasRef} />\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}