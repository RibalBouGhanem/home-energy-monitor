{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\senior-project\\\\web-template-new\\\\frontend\\\\src\\\\components\\\\charts\\\\LineTimeChart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef } from \"react\";\nimport Chart from \"chart.js/auto\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction toTs(v) {\n  if (v.contains(\"Z\")) return new Date(v).getTime();\n  return new Date(v).getDate();\n}\nexport default function LineTimeChart({\n  id,\n  rows = [],\n  xKey = \"Timestamp\",\n  yKeys = [],\n  labels = {},\n  // optional: { yKey: \"Label\" }\n  chartRef,\n  // optional: ref passed from parent for hover sync later\n  onHoverX\n}) {\n  _s();\n  const canvasRef = useRef(null);\n  const onHoverXRef = useRef(null);\n  const prepared = useMemo(() => {\n    const safeRows = Array.isArray(rows) ? rows : [];\n    const data = safeRows.map(r => {\n      const x = r === null || r === void 0 ? void 0 : r[xKey];\n      const ts = toTs(x);\n      if (!ts) return null;\n      return {\n        ...r,\n        __ts: ts\n      };\n    }).filter(Boolean).sort((a, b) => a.__ts - b.__ts);\n    return data;\n  }, [rows, xKey]);\n  useEffect(() => {\n    onHoverXRef.current = onHoverX || null;\n  }, [onHoverX]);\n  useEffect(() => {\n    if (!canvasRef.current) return;\n\n    // destroy existing chart if any\n    const existing = Chart.getChart(canvasRef.current);\n    if (existing) existing.destroy();\n    if (!prepared.length || !yKeys.length) return;\n    const datasets = yKeys.map(k => ({\n      label: labels[k] || k,\n      data: prepared.map(r => {\n        var _r$k;\n        return Number((_r$k = r === null || r === void 0 ? void 0 : r[k]) !== null && _r$k !== void 0 ? _r$k : null);\n      }),\n      spanGaps: true,\n      tension: 0.3,\n      pointRadius: 0\n    }));\n    const chart = new Chart(canvasRef.current, {\n      type: \"line\",\n      data: {\n        labels: prepared.map(r => r.__ts),\n        // store timestamps\n        datasets\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        interaction: {\n          mode: \"index\",\n          intersect: false\n        },\n        onHover: (_event, elements, chart) => {\n          const cb = onHoverXRef.current;\n          if (!cb) return;\n          if (elements && elements.length) {\n            var _chart$data$labels$id, _chart$data$labels;\n            const idx = elements[0].index;\n            const x = (_chart$data$labels$id = (_chart$data$labels = chart.data.labels) === null || _chart$data$labels === void 0 ? void 0 : _chart$data$labels[idx]) !== null && _chart$data$labels$id !== void 0 ? _chart$data$labels$id : null;\n            cb(x, idx);\n          } else {\n            cb(null, null);\n          }\n        },\n        plugins: {\n          legend: {\n            display: true\n          },\n          tooltip: {\n            callbacks: {\n              title: items => {\n                var _items$;\n                const v = items === null || items === void 0 ? void 0 : (_items$ = items[0]) === null || _items$ === void 0 ? void 0 : _items$.label;\n                return v ? new Date(Number(v)).toLocaleString() : \"\";\n              }\n            }\n          }\n        },\n        scales: {\n          x: {\n            ticks: {\n              callback: (_value, index) => {\n                var _prepared$index;\n                const ts = (_prepared$index = prepared[index]) === null || _prepared$index === void 0 ? void 0 : _prepared$index.__ts;\n                return ts ? new Date(ts).toLocaleDateString() : \"\";\n              },\n              maxRotation: 0,\n              autoSkip: true\n            }\n          },\n          y: {\n            ticks: {\n              precision: 0\n            }\n          }\n        }\n      }\n    });\n\n    // expose chart instance to parent if requested\n    if (chartRef) chartRef.current = chart;\n    return () => {\n      chart.destroy();\n      if (chartRef) chartRef.current = null;\n    };\n  }, [prepared, yKeys, labels]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      id: id,\n      ref: canvasRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n}\n_s(LineTimeChart, \"3z1EUiZ8DcgM6JOAQIk9y1J1/98=\");\n_c = LineTimeChart;\nvar _c;\n$RefreshReg$(_c, \"LineTimeChart\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","Chart","jsxDEV","_jsxDEV","toTs","v","contains","Date","getTime","getDate","LineTimeChart","id","rows","xKey","yKeys","labels","chartRef","onHoverX","_s","canvasRef","onHoverXRef","prepared","safeRows","Array","isArray","data","map","r","x","ts","__ts","filter","Boolean","sort","a","b","current","existing","getChart","destroy","length","datasets","k","label","_r$k","Number","spanGaps","tension","pointRadius","chart","type","options","responsive","maintainAspectRatio","interaction","mode","intersect","onHover","_event","elements","cb","_chart$data$labels$id","_chart$data$labels","idx","index","plugins","legend","display","tooltip","callbacks","title","items","_items$","toLocaleString","scales","ticks","callback","_value","_prepared$index","toLocaleDateString","maxRotation","autoSkip","y","precision","style","width","height","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/senior-project/web-template-new/frontend/src/components/charts/LineTimeChart.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef } from \"react\";\r\nimport Chart from \"chart.js/auto\";\r\n\r\nfunction toTs(v) {\r\n  if (v.contains(\"Z\")) return new Date(v).getTime();\r\n  return new Date(v).getDate();\r\n}\r\n\r\nexport default function LineTimeChart({\r\n  id,\r\n  rows = [],\r\n  xKey = \"Timestamp\",\r\n  yKeys = [],\r\n  labels = {}, // optional: { yKey: \"Label\" }\r\n  chartRef,    // optional: ref passed from parent for hover sync later\r\n  onHoverX,\r\n}) {\r\n  const canvasRef = useRef(null);\r\n  const onHoverXRef = useRef(null);\r\n\r\n  const prepared = useMemo(() => {\r\n    const safeRows = Array.isArray(rows) ? rows : [];\r\n    const data = safeRows\r\n      .map((r) => {\r\n        const x = r?.[xKey];\r\n        const ts = toTs(x);\r\n        if (!ts) return null;\r\n        return { ...r, __ts: ts };\r\n      })\r\n      .filter(Boolean)\r\n      .sort((a, b) => a.__ts - b.__ts);\r\n\r\n    return data;\r\n  }, [rows, xKey]);\r\n\r\n  useEffect(() => {\r\n    onHoverXRef.current = onHoverX || null;\r\n  }, [onHoverX]);\r\n\r\n  useEffect(() => {\r\n    if (!canvasRef.current) return;\r\n\r\n    // destroy existing chart if any\r\n    const existing = Chart.getChart(canvasRef.current);\r\n    if (existing) existing.destroy();\r\n\r\n    if (!prepared.length || !yKeys.length) return;\r\n\r\n    const datasets = yKeys.map((k) => ({\r\n      label: labels[k] || k,\r\n      data: prepared.map((r) => Number(r?.[k] ?? null)),\r\n      spanGaps: true,\r\n      tension: 0.3,\r\n      pointRadius: 0,\r\n    }));\r\n\r\n    const chart = new Chart(canvasRef.current, {\r\n      type: \"line\",\r\n      data: {\r\n        labels: prepared.map((r) => r.__ts), // store timestamps\r\n        datasets,\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        interaction: { mode: \"index\", intersect: false },\r\n        onHover: (_event, elements, chart) => {\r\n          const cb = onHoverXRef.current;\r\n          if (!cb) return;\r\n\r\n          if (elements && elements.length) {\r\n            const idx = elements[0].index;\r\n            const x = chart.data.labels?.[idx] ?? null;\r\n            cb(x, idx);\r\n          } else {\r\n            cb(null, null);\r\n          }\r\n        },\r\n        plugins: {\r\n          legend: { display: true },\r\n          tooltip: {\r\n            callbacks: {\r\n              title: (items) => {\r\n                const v = items?.[0]?.label;\r\n                return v ? new Date(Number(v)).toLocaleString() : \"\";\r\n              },\r\n            },\r\n          },\r\n        },\r\n        scales: {\r\n          x: {\r\n            ticks: {\r\n              callback: (_value, index) => {\r\n                const ts = prepared[index]?.__ts;\r\n                return ts ? new Date(ts).toLocaleDateString() : \"\";\r\n              },\r\n              maxRotation: 0,\r\n              autoSkip: true,\r\n            },\r\n          },\r\n          y: {\r\n            ticks: { precision: 0 },\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    // expose chart instance to parent if requested\r\n    if (chartRef) chartRef.current = chart;\r\n\r\n    return () => {\r\n      chart.destroy();\r\n      if (chartRef) chartRef.current = null;\r\n    };\r\n  }, [prepared, yKeys, labels]);\r\n\r\n  return (\r\n    <div style={{ width: \"100%\", height: \"100%\" }}>\r\n      <canvas id={id} ref={canvasRef} />\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}