{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\senior-project\\\\website\\\\frontend\\\\src\\\\components\\\\analytics\\\\Analytics.js\",\n  _s = $RefreshSig$();\n// src/components/analytics/Analytics.jsx\nimport React, { useMemo, useState } from \"react\";\nimport MetricsGrid from \"./MetricsGrid\";\nimport MonthlyTrendsChart from \"./userCharts/MonthlyTrendsChart\";\nimport GrowthAnalyticsChart from \"./userCharts/GrowthAnalyticsChart\";\nimport GeoDistributionChart from \"./userCharts/SolarContributionChart\";\nimport DeviceAnalyticsChart from \"./userCharts/ReservesTrend\";\nimport { useAnalyticsData } from \"./hooks/useAnalyticsData\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction safeParse(json, fallback) {\n  try {\n    const v = JSON.parse(json);\n    return v !== null && v !== void 0 ? v : fallback;\n  } catch {\n    return fallback;\n  }\n}\nexport default function Analytics() {\n  _s();\n  const [yearTab, setYearTab] = useState(\"2024\");\n  const [growthTab, setGrowthTab] = useState(\"Week\");\n\n  // monitorId from localStorage (first monitor)\n  const monitors = useMemo(() => safeParse(localStorage.getItem(\"monitors\"), []), []);\n  const monitorId = useMemo(() => {\n    var _first$Monitor_ID;\n    const first = monitors === null || monitors === void 0 ? void 0 : monitors[0];\n    const id = (_first$Monitor_ID = first === null || first === void 0 ? void 0 : first.Monitor_ID) !== null && _first$Monitor_ID !== void 0 ? _first$Monitor_ID : first === null || first === void 0 ? void 0 : first.monitor_id;\n    return id != null ? String(id) : \"\";\n  }, [monitors]);\n  const {\n    loading,\n    err,\n    todayCons,\n    todayProd,\n    mtdCons,\n    mtdProd,\n    solarTodayGenerated,\n    solarTodayEff,\n    avgTemp7,\n    avgHumidity7,\n    consM,\n    prodM,\n    cons7,\n    cons30,\n    prod7,\n    prod30,\n    solar7,\n    reserves7\n  } = useAnalyticsData(monitorId);\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"analytics-section\",\n    id: \"analytics\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dashboard-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"section-title\",\n        children: \"Advanced Analytics\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), !monitorId && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"muted\",\n        style: {\n          marginTop: 10\n        },\n        children: \"No monitor found for this account. (Try logging in again.)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this), loading && monitorId && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"muted\",\n        children: \"Loading analytics...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 34\n      }, this), err && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        children: err\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(MetricsGrid, {\n        metrics: [{\n          value: `${todayCons.toFixed(2)} kWh`,\n          label: \"Today's Consumption\"\n        }, {\n          value: `${todayProd.toFixed(2)} kWh`,\n          label: \"Today's Production\"\n        }, {\n          value: `${(mtdCons || 0).toFixed(1)} kWh`,\n          label: \"Last 30 Days Consumption\"\n        }, {\n          value: `${(mtdProd || 0).toFixed(1)} kWh`,\n          label: \"Last 30 Days Production\"\n        }, {\n          value: `${solarTodayEff.toFixed(1)}%`,\n          label: \"Panel Efficiency (Today)\"\n        }, {\n          value: `${avgTemp7.toFixed(1)}Â°C`,\n          label: \"Avg Temp (7d)\"\n        }]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"charts-grid\",\n        children: [/*#__PURE__*/_jsxDEV(MonthlyTrendsChart, {\n          activeYear: yearTab,\n          onChangeYear: setYearTab,\n          consumptionMonthly: consM,\n          productionMonthly: prodM\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(GrowthAnalyticsChart, {\n          activeRange: growthTab,\n          onChangeRange: setGrowthTab,\n          consumptionDaily: cons7,\n          consumptionDaily30: cons30,\n          productionDaily: prod7,\n          productionDaily30: prod30\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(GeoDistributionChart, {\n          title: \"\\u2600\\uFE0F Solar Contribution\",\n          subtitle: \"Last 7 days\",\n          solarDaily: solar7,\n          consumptionDaily: cons7\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DeviceAnalyticsChart, {\n          title: \"\\uD83E\\uDEAB Reserves Trend\",\n          subtitle: \"Last 7 days\",\n          reservesDaily: reserves7,\n          solarTodayGenerated: solarTodayGenerated\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s(Analytics, \"QTHTrgYUZVvWHQEthR4Fpdrg56w=\", false, function () {\n  return [useAnalyticsData];\n});\n_c = Analytics;\nvar _c;\n$RefreshReg$(_c, \"Analytics\");","map":{"version":3,"names":["React","useMemo","useState","MetricsGrid","MonthlyTrendsChart","GrowthAnalyticsChart","GeoDistributionChart","DeviceAnalyticsChart","useAnalyticsData","jsxDEV","_jsxDEV","safeParse","json","fallback","v","JSON","parse","Analytics","_s","yearTab","setYearTab","growthTab","setGrowthTab","monitors","localStorage","getItem","monitorId","_first$Monitor_ID","first","id","Monitor_ID","monitor_id","String","loading","err","todayCons","todayProd","mtdCons","mtdProd","solarTodayGenerated","solarTodayEff","avgTemp7","avgHumidity7","consM","prodM","cons7","cons30","prod7","prod30","solar7","reserves7","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","marginTop","metrics","value","toFixed","label","activeYear","onChangeYear","consumptionMonthly","productionMonthly","activeRange","onChangeRange","consumptionDaily","consumptionDaily30","productionDaily","productionDaily30","title","subtitle","solarDaily","reservesDaily","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/senior-project/website/frontend/src/components/analytics/Analytics.js"],"sourcesContent":["// src/components/analytics/Analytics.jsx\r\nimport React, { useMemo, useState } from \"react\";\r\nimport MetricsGrid from \"./MetricsGrid\";\r\nimport MonthlyTrendsChart from \"./userCharts/MonthlyTrendsChart\";\r\nimport GrowthAnalyticsChart from \"./userCharts/GrowthAnalyticsChart\";\r\nimport GeoDistributionChart from \"./userCharts/SolarContributionChart\";\r\nimport DeviceAnalyticsChart from \"./userCharts/ReservesTrend\";\r\nimport { useAnalyticsData } from \"./hooks/useAnalyticsData\";\r\n\r\nfunction safeParse(json, fallback) {\r\n  try {\r\n    const v = JSON.parse(json);\r\n    return v ?? fallback;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n}\r\n\r\nexport default function Analytics() {\r\n  const [yearTab, setYearTab] = useState(\"2024\");\r\n  const [growthTab, setGrowthTab] = useState(\"Week\");\r\n\r\n  // monitorId from localStorage (first monitor)\r\n  const monitors = useMemo(() => safeParse(localStorage.getItem(\"monitors\"), []), []);\r\n  const monitorId = useMemo(() => {\r\n    const first = monitors?.[0];\r\n    const id = first?.Monitor_ID ?? first?.monitor_id;\r\n    return id != null ? String(id) : \"\";\r\n  }, [monitors]);\r\n\r\n  const {\r\n    loading,\r\n    err,\r\n    todayCons,\r\n    todayProd,\r\n    mtdCons,\r\n    mtdProd,\r\n    solarTodayGenerated,\r\n    solarTodayEff,\r\n    avgTemp7,\r\n    avgHumidity7,\r\n    consM,\r\n    prodM,\r\n    cons7,\r\n    cons30,\r\n    prod7,\r\n    prod30,\r\n    solar7,\r\n    reserves7,\r\n  } = useAnalyticsData(monitorId);\r\n\r\n  return (\r\n    <section className=\"analytics-section\" id=\"analytics\">\r\n      <div className=\"dashboard-container\">\r\n        <h2 className=\"section-title\">Advanced Analytics</h2>\r\n\r\n        {!monitorId && (\r\n          <div className=\"muted\" style={{ marginTop: 10 }}>\r\n            No monitor found for this account. (Try logging in again.)\r\n          </div>\r\n        )}\r\n\r\n        {loading && monitorId && <div className=\"muted\">Loading analytics...</div>}\r\n        {err && <div className=\"error\">{err}</div>}\r\n\r\n        <MetricsGrid\r\n          metrics={[\r\n            { value: `${todayCons.toFixed(2)} kWh`, label: \"Today's Consumption\" },\r\n            { value: `${todayProd.toFixed(2)} kWh`, label: \"Today's Production\" },\r\n            { value: `${(mtdCons || 0).toFixed(1)} kWh`, label: \"Last 30 Days Consumption\" },\r\n            { value: `${(mtdProd || 0).toFixed(1)} kWh`, label: \"Last 30 Days Production\" },\r\n            { value: `${solarTodayEff.toFixed(1)}%`, label: \"Panel Efficiency (Today)\" },\r\n            { value: `${avgTemp7.toFixed(1)}Â°C`, label: \"Avg Temp (7d)\" },\r\n          ]}\r\n        />\r\n\r\n        <div className=\"charts-grid\">\r\n          <MonthlyTrendsChart\r\n            activeYear={yearTab}\r\n            onChangeYear={setYearTab}\r\n            consumptionMonthly={consM}\r\n            productionMonthly={prodM}\r\n          />\r\n\r\n          <GrowthAnalyticsChart\r\n            activeRange={growthTab}\r\n            onChangeRange={setGrowthTab}\r\n            consumptionDaily={cons7}\r\n            consumptionDaily30={cons30}\r\n            productionDaily={prod7}\r\n            productionDaily30={prod30}\r\n          />\r\n\r\n          {/* Repurposed: Energy Mix (Solar vs Consumption) */}\r\n          <GeoDistributionChart\r\n            title=\"â˜€ï¸ Solar Contribution\"\r\n            subtitle=\"Last 7 days\"\r\n            solarDaily={solar7}\r\n            consumptionDaily={cons7}\r\n          />\r\n\r\n          {/* Repurposed: Reserves trend */}\r\n          <DeviceAnalyticsChart\r\n            title=\"ðŸª« Reserves Trend\"\r\n            subtitle=\"Last 7 days\"\r\n            reservesDaily={reserves7}\r\n            solarTodayGenerated={solarTodayGenerated}\r\n          />\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}